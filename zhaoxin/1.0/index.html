<!doctype html>
<html lang="zh-cn">
<head>
    <meta name="viewport" content="initial-scale=1, user-scalable=0, minimal-ui" charset="UTF-8">
    <title>S派</title>
    <link href="css/style_m.css?t=1" type="text/css" rel="stylesheet" media="all" />

	<script src="js/public.js"></script>
    <script src="js/jquery.min.js"></script>
    <script type="text/javascript" src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
    <script>
        (function(){
            var phoneWidth = parseInt(window.screen.width),
                    phoneScale = phoneWidth/640,
                    ua = navigator.userAgent;
            if (/Android (\d+\.\d+)/.test(ua)){
                var version = parseFloat(RegExp.$1);
                // andriod 2.3
                if(version > 2.3){
                    document.write('<meta name="viewport" content="width=640, minimum-scale = '+phoneScale+', maximum-scale = '+phoneScale+', target-densitydpi=device-dpi">');
                    // andriod 2.3以上
                }else{
                    document.write('<meta name="viewport" content="width=640, target-densitydpi=device-dpi">');
                }
                // 其他系统
            } else {
                /*document.write('<meta name="viewport" content="width=640, user-scalable=no, target-densitydpi=device-dpi">');*/
                document.write('<meta name="viewport" content="width=640, minimum-scale = '+phoneScale+', maximum-scale = '+phoneScale+', target-densitydpi=device-dpi">');
            }
        })();
        $.ajax({
            type : "GET",
            dataType : "json",
            url : publicUrl+'a/?m=share&a=collegeLists',
            success : function(data){
                if(data.code==1){
                    if(data.data.lists.length>0){
                        var resultSchool='';
                        for(var i=0; i<data.data.lists.length;i++){
                            resultSchool+='<option value="'+data.data.lists[i].coid+'">'+data.data.lists[i].name+'</option>';
                        }
                        $(".select_school").append(resultSchool);
                    }
                }else{
                    alert(data.msg);
                }
            }
        })
    </script>
</head>
<body>
    <div class="bg_1" style="display: block;">
        <div class="bg_1_kong"></div>
        <div class="first_word">
            挨过了斯巴达式教育、
            熬过了高考，终于来到了
            传说中可以释放天性，
            自由翱翔的大学。
        </div>
        <div class="select_school_div" onchange="collegeLists()">
            <select class="select_school" >
                <option value="0">探索你的大学</option>
            </select>
        </div>
        <div class="word_2">
            可是心中为什么会有点不舍呢，
            或许是因为再也没有一群一起
            为了同一个目标熬夜奋战的小伙伴了，
            或许自己这辈子再也不会为了一件事
            那么认真了吧。嗯？社团？

        </div>
        <div class="shetuan">
            <div class="shetuan_left">
                <span></span>社团清单
            </div>
            <div class="shetuan_right">
                <select class="shetuan_type"onchange="collegeLists2()">
                    <option value="0">类型选择</option>

                </select>
            </div>
        </div>
        <div class="shetuan_list">
            <!--<div class="shetuan_list_1">
                <div class="shetuan_name">
                    社团名称1
                </div>
                <div class="xiangqing" style="display: none">
                    <div class="xiangqing_left">
                        <div class="xiangqing_avatar"><img src=""></div>
                        <div class="shezhang_name">社长:社长名</div>
                    </div>
                    <div class="xiangqing_word">
                            详情详情详情详情详情详情详情

                    </div>
                    <div class="xiangqing_check">
                        报名<input type="checkbox" name="choiceThis" value="1">
                    </div>
                </div>
            </div>-->



            <!--详情列表 stop-->
        </div>
        <!-- 列表stop-->
        <div class="shetuan_checked">
            <div class="shetuan_checked_left">
                <!--<div class="shetuan_checked_left_1" id="shetuan_1">1) 你所报名的社团<span></span></div>
                <div class="shetuan_checked_left_1" id="shetuan_2">2) 你所报名的社团<span></span></div>
                <div class="shetuan_checked_left_1" id="shetuan_3">3) 你所报名的社团<span></span></div>-->
            </div>
            <div class="button_baoming"><a href="javascript:void(0)">报名</a></div>
        </div>
    </div>
    <!-- pageOne stop-->
    <!-- pageTwo start-->
    <div class="bg_2" style="display: none">
        <div class="bg_2_kong"></div>
        <div class="bg_2_first_word">
            这好像和高中那会儿简单
            的兴趣爱好式的不一样诶，
            或许在这里我能为自己
            真正喜欢的东西奋斗！

        </div>
        <div class="shetuan_qingdan_word">
            <span></span>社团清单
        </div>
        <div class="shetuan_qingdan_list">
            <!--<div class="shetuan_qingdan_1">1) 你所报名的社团# <span></span></div>
            <div class="shetuan_qingdan_1">2) 你所报名的社团</div>
            <div class="shetuan_qingdan_1">3) 你所报名的社团</div>-->
        </div>
        <div class="form_user">
            <div class="form_input"><label>姓名：</label><input type="text" id="sub_truename" placeholder="请填写姓名"></div>
            <div class="form_input"><label>专业：</label><input type="text" id="sub_specialty"  placeholder="请填写专业"></div>
            <div class="form_input"><label>联系电话：</label><input type="number" id="sub_phone" placeholder="请填写电话"></div>
            <div class="form_input"><label>微信：</label><input type="text"id="sub_weixin" placeholder="请填写微信"></div>
            <div class="form_input"><label>QQ：</label><input type="number" id="sub_qq" placeholder="请填写QQ"></div>
            <div class="form_input" id="form_input">
                <label>自我介绍与特长（选填）</label></br>
                <textarea id="sub_profile">

                </textarea>
            </div>
        </div>
        <div class="button_tijiao"><a href="javascript:void(0)">提交</a></div>
    </div>
    <!-- pageTwo stop-->
    <!-- pageThree start-->
    <div class="bg_3" style="display: none;">
        <div class="bg_3_kong"></div>
        <div class="bg_logo"></div>
        <div class="bg_3_word">
            <div class="bg_word_1">
                <p>开启不一样的大学生活</p>
                <p>专属钥匙已用短信发给你了</p>
                <p>无需注册</p>
                <p>下载S派直接登录即可</p>
            </div>
            <div class="shareToFriend">
                <p>分享至朋友圈</p>
                <p>可获得幸运免费手机流量</p>
            </div>
            <div class="prize_liuliang">
                <p>1G手机流量999人</p>
                <p>500M手机流量1999人</p>
                <p>100M手机流量2999人</p>
                <p>以上手机流量覆盖移动、联通、铁通运营商</p>
            </div>
        </div>
        <div class="buttons">
            <div class="bg_3_button_1"><a href="http://a.app.qq.com/o/simple.jsp?pkgname=com.app.spire">下载S派</a></div>
            <div class="bg_3_button_2"><a href="javascript:void(0)">分享</a></div>
        </div>
    </div>
    <!-- pageThree stop-->
    <input type="hidden" value="0" class="shetuanbianhao">
    <!--分享风格1-->
    <!--<div class="share" style="display: none" onclick="shareHidden()">
        <div class="share_word">怎么分享给朋友？你猜☞</div>
    </div>-->
    <!--分享风格2-->
    <div class="share2" style="display: none" >

    </div>


<script>
    $(".button_baoming").click(function(){
        if($(".shetuanbianhao").val()==0){
            alert('最少选一个社团哦！');
        }else{
            $(".bg_1").hide();
            $(".bg_3").hide();
            $(".bg_2").show();
        }
    })
    $(".bg_3_button_2").click(function(){
        $(".share2").toggle();
    })
    $(".button_tijiao").click(function(){
        var shetuanbianhao = $(".shetuanbianhao").val();
        var cids=shetuanbianhao.substring(0,shetuanbianhao.length-1);
        var truename=$("#sub_truename").val();
        var specialty=$("#sub_specialty").val();
        var phone=$("#sub_phone").val();
        var weixin=$("#sub_weixin").val();
        var qq=$("#sub_qq").val();
        var profile=$("#sub_profile").val();
        if(truename=='' || specialty=='' || phone=='' || weixin=='' || qq==''){
            alert('资料不全');
        }else{
            $.ajax({
                type : "POST",
                dataType : "json",
                url : publicUrl+'a/?m=share&a=register',
                data: 'cids='+cids+'&truename='+truename+'&specialty='+specialty+'&phone='+phone+'&weixin='+weixin+'&qq='+qq+'&profile='+profile,
                success : function(data){
                    if(data.code==1){
                        alert('提交成功');
                        $(".bg_2").hide();
                        $(".bg_1").hide();
                        $(".bg_3").show();
                    }else{
                        alert(data.msg);
                    }
                }
            })
        }

        /*$(".bg_2").hide();
        $(".bg_1").hide();
        $(".bg_3").show();*/
    })
    $(".bg_2").hide();
    $(".bg_1").show();
    $(".bg_3").hide();
    /*function shareHidden(){
        $(".share").hide();
    }
    $(".bg_3_button_2").click(function(){
        $(".share").show();
    })*/
    /*$("input[type=checkbox]").click(function(){
        if($("input[name=choiceThis]:checked").length>=4){
            $(this).removeAttr("checked");
            alert("最多选3个!");
        }else if($("input[name=choiceThis]:checked").length==0){
            var baoshetuan='<div class="shetuan_checked_left_1" ><span></span></div>';
            $(".shetuan_checked_left").html(baoshetuan);
            $(".shetuanbianhao").val(0);
        }else{
            var baoshetuan='';
            var baoshetuan2='';
            var shetuan_id=1;
            var shetuanbianhao='';
            $("input[name='choiceThis']:checkbox:checked").each(function(){
                baoshetuan+='<div class="shetuan_checked_left_1" id="shetuan_'+shetuan_id+'">'+shetuan_id+')你所报名的社团<span>'+$(this).parent().parent().parent().children('.shetuan_name').html()+'</span></div>';
                baoshetuan2+='<div class="shetuan_qingdan_1" id="shetuans_'+shetuan_id+'">'+shetuan_id+')你所报名的社团<span>'+$(this).parent().parent().parent().children('.shetuan_name').html()+'</span></div>';
                $(".shetuan_checked_left").html(baoshetuan);
                $(".shetuan_qingdan_list").html(baoshetuan);
                shetuanbianhao+=$(this).val()+',';

                $(".shetuanbianhao").val(shetuanbianhao);
                shetuan_id++;

            });
        }
    })*/
    function collegeLists(){
        //alert('选定后就不能更改了哦！');
        /*var resultType='<option value="0">类型选择</option>';
        $(".shetuan_type").html(resultType);*/
        var resultList='';
        $(".shetuan_list").html(resultList);
        var coid=$(".select_school").find("option:selected").val();

        var school=$(".select_school").find("option:selected").text();

        if($(".shetuan_type").val()==0){
            var typeid='';
        }else{
            var typeid=$(".shetuan_type").val();
        }
        $(".shetuan_left span").html(school);
        $(".shetuan_qingdan_word span").html(school);
        $.ajax({
            type : "POST",
            dataType : "json",
            url : publicUrl+'a/?m=share&a=clubLists',
            data: 'coid='+coid+'&typeid='+typeid,
            success : function(data){
                if(data.code==1){

                    //alert(data.data.lists.length);
                    if(data.data.lists.length>0){
                        resultList='';
                        for(var iList=0; iList<data.data.lists.length;iList++){
                            resultList+=
                                '<div class="shetuan_list_1">'
                                +'    <div class="shetuan_name">'
                                +data.data.lists[iList].name
                                +'   </div>'
                                +'   <div class="xiangqing" style="display: none">'
                                +'    <div class="xiangqing_left">'
                                +'    <div class="xiangqing_avatar"><img src="'+data.data.lists[iList].avatar+'"></div>'
                                +'    <div class="shezhang_name">'+data.data.lists[iList].fname+'</div>'
                                +'</div>'
                                +'<div class="xiangqing_word">'
                                +data.data.lists[iList].slogan

                                +'</div>'
                                +'<div class="xiangqing_check">'
                                +'    报名<input type="checkbox" name="choiceThis" value="'+data.data.lists[iList].cid+'">'
                                +'    </div>'
                                +'    </div>'
                                +'    </div>';
                        }
                        //alert(resultList);
                        $(".shetuan_list").html(resultList);
                        $(".shetuan_list_1").click(function(){
                            $(".xiangqing").hide();
                            $(this).children('.xiangqing').toggle();
                        })
                        $("input[type=checkbox]").click(function(){
                            if($("input[name=choiceThis]:checked").length>=4){
                                $(this).removeAttr("checked");
                                alert("最多选3个!");
                            }else if($("input[name=choiceThis]:checked").length==0){
                                var baoshetuan='<div class="shetuan_checked_left_1" ><span></span></div>';
                                $(".shetuan_checked_left").html(baoshetuan);
                                $(".shetuanbianhao").val(0);
                            }else{
                                var baoshetuan='';
                                var baoshetuan2='';
                                var shetuan_id=1;
                                var shetuanbianhao='';
                                $("input[name='choiceThis']:checkbox:checked").each(function(){
                                    baoshetuan+='<div class="shetuan_checked_left_1" id="shetuan_'+shetuan_id+'">'+shetuan_id+')你所报名的社团#<span>'+$(this).parent().parent().parent().children('.shetuan_name').html()+'</span></div>';
                                    baoshetuan2+='<div class="shetuan_qingdan_1" id="shetuans_'+shetuan_id+'">'+shetuan_id+')你所报名的社团#<span>'+$(this).parent().parent().parent().children('.shetuan_name').html()+'</span></div>';
                                    $(".shetuan_checked_left").html(baoshetuan);
                                    $(".shetuan_qingdan_list").html(baoshetuan);
                                    shetuanbianhao+=$(this).val()+',';
                                    $(".shetuanbianhao").val(shetuanbianhao);
                                    shetuan_id++;

                                });
                            }
                        })
                    }
                    if(typeid<=0){
                        if(data.data.type_lists.length>0){
                            resultType='<option value="0">类型选择</option>';
                            for(var iType=0; iType<data.data.type_lists.length;iType++){
                                resultType+='<option value="'+data.data.type_lists[iType].typeid+'">'+data.data.type_lists[iType].typename+'</option>';
                            }
                            $(".shetuan_type").html(resultType);
                        }
                    }else{
                        if(data.data.type_lists!='undefined'){
                            resultType='<option value="0">类型选择</option>';
                            $(".shetuan_type").html(resultType);
                        }else{
                            resultType='<option value="0">类型选择</option>';
                            for(var iType=0; iType<data.data.type_lists.length;iType++){
                                resultType+='<option value="'+data.data.type_lists[iType].typeid+'">'+data.data.type_lists[iType].typename+'</option>';
                            }
                            $(".shetuan_type").html(resultType);
                        }
                    }
                }else{
                    alert(data.msg);
                }
            }
        })
    }
    function collegeLists2(){
        //alert('选定后就不能更改了哦！');
        /*var resultType='<option value="0">类型选择</option>';
         $(".shetuan_type").html(resultType);*/
        var resultList='';
        $(".shetuan_list").html(resultList);
        var coid=$(".select_school").find("option:selected").val();

        var school=$(".select_school").find("option:selected").text();

        if($(".shetuan_type").val()==0){
            var typeid='';
        }else{
            var typeid=$(".shetuan_type").val();
        }
        $(".shetuan_left span").html(school);
        $(".shetuan_qingdan_word span").html(school);
        $.ajax({
            type : "POST",
            dataType : "json",
            url : publicUrl+'a/?m=share&a=clubLists',
            data: 'coid='+coid+'&typeid='+typeid,
            success : function(data){
                if(data.code==1){

                    //alert(data.data.lists.length);
                    if(data.data.lists.length>0){
                        resultList='';
                        for(var iList=0; iList<data.data.lists.length;iList++){
                            resultList+=
                                    '<div class="shetuan_list_1">'
                                    +'    <div class="shetuan_name">'
                                    +data.data.lists[iList].name
                                    +'   </div>'
                                    +'   <div class="xiangqing" style="display: none">'
                                    +'    <div class="xiangqing_left">'
                                    +'    <div class="xiangqing_avatar"><img src="'+data.data.lists[iList].avatar+'"></div>'
                                    +'    <div class="shezhang_name">'+data.data.lists[iList].fname+'</div>'
                                    +'</div>'
                                    +'<div class="xiangqing_word">'
                                    +data.data.lists[iList].slogan

                                    +'</div>'
                                    +'<div class="xiangqing_check">'
                                    +'    报名<input type="checkbox" name="choiceThis" value="'+data.data.lists[iList].cid+'">'
                                    +'    </div>'
                                    +'    </div>'
                                    +'    </div>';
                        }
                        //alert(resultList);
                        $(".shetuan_list").html(resultList);
                        $(".shetuan_list_1").click(function(){
                            $(".xiangqing").hide();
                            $(this).children('.xiangqing').toggle();
                        })
                        $("input[type=checkbox]").click(function(){
                            if($("input[name=choiceThis]:checked").length>=4){
                                $(this).removeAttr("checked");
                                alert("最多选3个!");
                            }else if($("input[name=choiceThis]:checked").length==0){
                                var baoshetuan='<div class="shetuan_checked_left_1" ><span></span></div>';
                                $(".shetuan_checked_left").html(baoshetuan);
                                $(".shetuanbianhao").val(0);
                            }else{
                                var baoshetuan='';
                                var baoshetuan2='';
                                var shetuan_id=1;
                                var shetuanbianhao='';
                                $("input[name='choiceThis']:checkbox:checked").each(function(){
                                    baoshetuan+='<div class="shetuan_checked_left_1" id="shetuan_'+shetuan_id+'">'+shetuan_id+')你所报名的社团#<span>'+$(this).parent().parent().parent().children('.shetuan_name').html()+'</span></div>';
                                    baoshetuan2+='<div class="shetuan_qingdan_1" id="shetuans_'+shetuan_id+'">'+shetuan_id+')你所报名的社团#<span>'+$(this).parent().parent().parent().children('.shetuan_name').html()+'</span></div>';
                                    $(".shetuan_checked_left").html(baoshetuan);
                                    $(".shetuan_qingdan_list").html(baoshetuan);
                                    shetuanbianhao+=$(this).val()+',';
                                    $(".shetuanbianhao").val(shetuanbianhao);
                                    shetuan_id++;

                                });
                            }
                        })
                    }

                }else{
                    alert(data.msg);
                }
            }
        })
    }
    $(document).ready(function(){
        $(".shetuan_list_1").click(function(){
            $(".xiangqing").hide();
            $(this).children('.xiangqing').toggle();
        })
    })
</script>
    <script>
        var urls="http://share.spai.me/api/index.php?type=getShareKey&url="+encodeURIComponent(location.href.split('#')[0]);
        var shareUrl=location.href.split('#')[0];
        //var shareUrl=$(".shareUrl").val();
        var shareTitle='招新季！';
        var shareContent='简单点招新的方式简单点，复杂的流程请省略～S派线上招新，申请社团一步到位！';
        var shareImg='http://share.spai.me/m/cc/new/img/logo.png';
        $.ajax(
                {
                    type : "GET",
                    //async : false,
                    dataType : "json",
                    url : urls,
                    success : function(d){

                        r = d.data;
                        //alert(r.result.appId);
                        //alert(r.result.timestamp);
                        //alert(r.result.noncestr);
                        //alert(r.result.signature);
                        if(r.result.appId){
                            //console.log(result)
                            wx.config({
                                debug: false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。
                                appId: r.result.appId, // 必填，公众号的唯一标识
                                timestamp: r.result.timestamp, // 必填，生成签名的时间戳
                                nonceStr: r.result.noncestr, // 必填，生成签名的随机串
                                signature: r.result.signature,// 必填，签名，见附录1
                                jsApiList: [
                                    'checkJsApi',
                                    'onMenuShareTimeline',
                                    'onMenuShareAppMessage',
                                    'onMenuShareQQ',
                                    'onMenuShareWeibo',
                                    'hideMenuItems',
                                    'showMenuItems',
                                    'hideAllNonBaseMenuItem',
                                    'showAllNonBaseMenuItem',
                                    'translateVoice',
                                    'startRecord',
                                    'stopRecord',
                                    'onRecordEnd',
                                    'playVoice',
                                    'pauseVoice',
                                    'stopVoice',
                                    'uploadVoice',
                                    'downloadVoice',
                                    'chooseImage',
                                    'previewImage',
                                    'uploadImage',
                                    'downloadImage',
                                    'getNetworkType',
                                    'openLocation',
                                    'getLocation',
                                    'hideOptionMenu',
                                    'showOptionMenu',
                                    'closeWindow',
                                    'scanQRCode',
                                    'chooseWXPay',
                                    'openProductSpecificView',
                                    'addCard',
                                    'chooseCard',
                                    'openCard'
                                ] // 必填，需要使用的JS接口列表，所有JS接口列表见附录2
                            });
                            wx.ready(function(){
                                //alert('ok1');
                                //分享到朋友圈
                                wx.onMenuShareTimeline({
                                    title: shareContent, // 分享标题
                                    link: shareUrl, // 分享链接
                                    imgUrl: shareImg, // 分享图标
                                    success: function () {
                                        //alert('ok');
                                        // 用户确认分享后执行的回调函数
                                    },
                                    cancel: function () {
                                        //alert('cancel');
                                        // 用户取消分享后执行的回调函数
                                    }
                                });
                                //分享到朋友
                                wx.onMenuShareAppMessage({
                                    title: shareTitle, // 分享标题
                                    desc: shareContent,//描述
                                    link: shareUrl, // 分享链接
                                    imgUrl: shareImg, // 分享图标
                                    success: function () {
                                        //alert('ok');
                                        // 用户确认分享后执行的回调函数
                                    },
                                    cancel: function () {
                                        //alert('cancel');
                                        // 用户取消分享后执行的回调函数
                                    }
                                });
                                /*				wx.getLocation({
                                 success: function (res) {
                                 var latitude = res.latitude; // 纬度，浮点数，范围为90 ~ -90
                                 alert(latitude);
                                 var longitude = res.longitude; // 经度，浮点数，范围为180 ~ -180。
                                 var speed = res.speed; // 速度，以米/每秒计
                                 var accuracy = res.accuracy; // 位置精度
                                 }
                                 });*/
                                //分享到QQ
                                wx.onMenuShareQQ({
                                    title: shareTitle, // 分享标题
                                    desc: shareContent,//描述
                                    link: shareUrl, // 分享链接
                                    imgUrl: shareImg, // 分享图标
                                    success: function () {
                                        //alert('ok');
                                        // 用户确认分享后执行的回调函数
                                    },
                                    cancel: function () {
                                        //alert('cancel');
                                        // 用户取消分享后执行的回调函数
                                    }
                                });
                                //分享到微博
                                wx.onMenuShareWeibo({
                                    title: shareTitle, // 分享标题
                                    desc:shareContent,//描述
                                    link: shareUrl, // 分享链接
                                    imgUrl: shareImg, // 分享图标
                                    success: function () {
                                        //alert('ok');
                                        // 用户确认分享后执行的回调函数
                                    },
                                    cancel: function () {
                                        //alert('cancel');
                                        // 用户取消分享后执行的回调函数
                                    }
                                });
                                // config信息验证后会执行ready方法，所有接口调用都必须在config接口获得结果之后，config是一个客户端的异步操作，所以如果需要在页面加载时就调用相关接口，则须把相关接口放在ready函数中调用来确保正确执行。对于用户触发时才调用的接口，则可以直接调用，不需要放在ready函数中。
                            });
                            wx.error(function(res){

                                // config信息验证失败会执行error函数，如签名过期导致验证失败，具体错误信息可以打开config的debug模式查看，也可以在返回的res参数中查看，对于SPA可以在这里更新签名。

                            });
                            //e

                        }else{
                            //错误
                            alert(r.status.msg);
                        }
                    }
                });
    </script>
</body>
</html>